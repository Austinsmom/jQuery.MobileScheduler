!function(a){a.fn.MobileScheduler=function(b){var c=a.extend({date:new Date,use24HourClock:!0,events:[],prevClass:"icon-arrow-left5",nextClass:"icon-arrow-right5",onEventClick:function(a,b){},labels:{allday:"all-day",months:["January","February","March","April","May","June","July","August","September","October","November","December"],days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}},b),d=this,e=function(b){var f=new Date,g=function(){d.find(".jqms-month-view").on("webkitAnimationEnd animationend",function(){e("animated slideInRight")}).addClass("animated slideOutLeft"),11===c.date.getMonth()?(c.date.setMonth(0),c.date.setFullYear(c.date.getFullYear()+1)):c.date.setMonth(c.date.getMonth()+1)},h=function(){d.find(".jqms-month-view").on("webkitAnimationEnd animationend",function(){e("animated slideInLeft")}).addClass("animated slideOutRight"),0===c.date.getMonth()?(c.date.setMonth(11),c.date.setFullYear(c.date.getFullYear()-1)):c.date.setMonth(c.date.getMonth()-1)};d.empty(),d.addClass("jqms-calendar");var i=a('<div class="jqms-header"><div class="jqms-month"><a class="jqms-previous"><i class="'+c.prevClass+'"></i></a>'+c.labels.months[c.date.getMonth()]+", "+c.date.getFullYear()+'<a class="jqms-next"><i class="'+c.nextClass+'"></a></div><div class="jqms-days" tabindex="-1"></div></div>'),j=i.find(".jqms-days");_.each(c.labels.days,function(a){j.append('<div class="jqms-day">'+a+"</div>")}),i.find(".jqms-previous").click(function(a){a.preventDefault(),a.stopPropagation(),h()}),i.find(".jqms-next").click(function(a){a.preventDefault(),a.stopPropagation(),g()}),d.append(i);for(var k=a('<div class="jqms-view-container"><div class="jqms-month-view-container"><div class="jqms-month-view '+(_.isString(b)?b:"")+'" tabindex="-1"></div></div><div class="jqms-list-view"><ul class="jqms-list-items"></ul></div></div>'),l=k.find(".jqms-month-view"),m=new Date(c.date.getFullYear(),c.date.getMonth(),1),n=0;n<m.getDay();n++)l.append('<div class="jqms-day-cell"></div>');for(var o=_.filter(c.events,function(a){return!!(a&&a.start&&c&&c.date)&&(a.allday?a.start.getUTCFullYear()===c.date.getFullYear()&&a.start.getUTCMonth()===c.date.getMonth():a.start.getFullYear()===c.date.getFullYear()&&a.start.getMonth()===c.date.getMonth())}),p=new Date(c.date.getFullYear(),c.date.getMonth()+1,0).getDate(),q=1;q<=p;q++){var r=a('<div class="jqms-day-cell"></div>');r.append("<span>"+q+"</span>"),r.data("day",q),r.click(function(){c.date.setDate(a(this).data("day")),e()}),f.getFullYear()===c.date.getFullYear()&&f.getMonth()===c.date.getMonth()&&f.getDate()===q&&r.addClass("jqms-today"),c.date.getDate()===q&&r.addClass("jqms-active"),_.filter(o,function(a){return a&&a.start&&(!a.allday&&a.start.getDate()===q||a.allday&&a.start.getUTCDate()===q)}).length>0&&r.append("<span>&#9679;</span>"),l.append(r)}p+n>35?l.addClass("jqms-long"):p+n===28&&l.addClass("jqms-short"),l.on("webkitAnimationEnd animationend",function(){l.removeClass("animated slideInRight slideInLeft")}),l.click(function(a){a.preventDefault(),a.stopPropagation()});var s=_.filter(o,function(a){return a&&a.start&&(!a.allday&&a.start.getDate()===c.date.getDate()||a.allday&&a.start.getUTCDate()===c.date.getDate())}),t=k.find(".jqms-list-items");if(_.each(_.sortBy(s,function(a){return a.start.getTime()}),function(b){var d=c.labels.allday,e=c.labels.allday;if(!b.allday)if(c.use24HourClock)d=(b.start.getHours()<10?"0":"")+b.start.getHours()+":"+(b.start.getMinutes()<10?"0":"")+b.start.getMinutes(),e=(b.end.getHours()<10?"0":"")+b.end.getHours()+":"+(b.end.getMinutes()<10?"0":"")+b.end.getMinutes();else{var f=b.start.getHours()%12,g=b.end.getHours()%12;0===f&&(f=12),0===g&&(g=12),d=(f<10?"0":"")+f+":"+(b.start.getMinutes()<10?"0":"")+b.start.getMinutes()+(b.start.getHours()>12?" PM":" AM"),e=(g<10?"0":"")+g+":"+(b.end.getMinutes()<10?"0":"")+b.end.getMinutes()+(b.end.getHours()>12?" PM":" AM")}var h=a("<li><div><span>"+d+"</span><span>"+e+"</span></div><span>"+b.title+"</span></li>");h.data("event",JSON.stringify(b)),h.click(function(b){c.onEventClick(b,JSON.parse(a(this).data("event")))}),t.append(h)}),d.append(k),window.IScroll){var u=new IScroll(d.find(".jqms-month-view-container")[0],{disableMouse:!0,disablePointer:!0,bindToWrapper:!0,scrollX:!0,probeType:3,eventPassthrough:!0}),v=!1,w=!1;u.on("scroll",function(b){this.x>.05*a(window).width()?v=!0:this.x<-(.05*a(window).width())?w=!0:(v=!1,w=!1)}),d.find(".jqms-month-view").on("touchend",function(){w?g():v&&h()})}};return e(),this}}(jQuery);