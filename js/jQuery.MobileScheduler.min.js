!function(a){a.fn.MobileScheduler=function(b){var c=a.extend({date:new Date,use24HourClock:!0,events:[],prevClass:"icon-arrow-left5",nextClass:"icon-arrow-right5",onEventClick:function(a,b){},onEventCreate:function(a,b){},labels:{allday:"all-day",newevent:"New",today:"Today",ends:"Ends",months:["January","February","March","April","May","June","July","August","September","October","November","December"],days:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}},b),d=this,e=function(b){var f=new Date,g=function(){d.find(".jqms-month-view").on("webkitAnimationEnd animationend",function(){e("animated slideInRight")}).addClass("animated slideOutLeft"),11===c.date.getMonth()?(c.date.setMonth(0),c.date.setFullYear(c.date.getFullYear()+1)):c.date.setMonth(c.date.getMonth()+1)},h=function(){d.find(".jqms-month-view").on("webkitAnimationEnd animationend",function(){e("animated slideInLeft")}).addClass("animated slideOutRight"),0===c.date.getMonth()?(c.date.setMonth(11),c.date.setFullYear(c.date.getFullYear()-1)):c.date.setMonth(c.date.getMonth()-1)};d.empty(),d.addClass("jqms-calendar");var i=a('<div class="jqms-header"><div class="jqms-month"><a class="jqms-previous"><i class="'+c.prevClass+'"></i></a><a class="jqms-month-picker">'+c.labels.months[c.date.getMonth()]+", "+c.date.getFullYear()+'</a><a class="jqms-next"><i class="'+c.nextClass+'"></i></a></div><div class="jqms-days"></div><div class="jqms-picker"><div class="jqms-picker-header"><a class="jqms-picker-previous"><i class="'+c.prevClass+'"></i></a><span class="jqms-picker-title">'+c.date.getFullYear()+'</span><a class="jqms-picker-next"><i class="'+c.nextClass+'"></a></div><div class="jqms-months"></div></div></div>'),j=i.find(".jqms-days");_.each(c.labels.days,function(a){j.append('<div class="jqms-day">'+a+"</div>")}),i.find(".jqms-previous").click(function(a){a.preventDefault(),a.stopPropagation(),h()}),i.find(".jqms-next").click(function(a){a.preventDefault(),a.stopPropagation(),g()});var k=function(a,b){if(_.isNumber(a)&&_.isNumber(b)){var f="animated ",g="animated ";a<c.date.getFullYear()?(f+="slideInLeft",g+="slideOutRight"):a>c.date.getFullYear()?(f+="slideInRight",g+="slideOutLeft"):b<c.date.getMonth()?(f+="slideInLeft",g+="slideOutRight"):b>c.date.getMonth()&&(f+="slideInRight",g+="slideOutLeft"),c.date.setFullYear(a),c.date.setMonth(b),d.find(".jqms-month-view").on("webkitAnimationEnd animationend",function(){e(f)}).addClass(g)}};i.find(".jqms-month-picker").click(function(a){a.preventDefault(),a.stopPropagation(),d.find(".jqms-picker").css("display","flex").on("click",function(a){a.stopPropagation()}),d.on("click",function(){d.find(".jqms-picker").css("display","none"),d.off("click")})});var l=i.find(".jqms-picker");l.data("year",c.date.getFullYear()),_.each(c.labels.months,function(a,b){l.find(".jqms-months").append('<button class="jqms-month" data-month="'+b+'">'+a+"</button>")}),l.find(".jqms-month").click(function(){k(parseInt(l.data("year")),parseInt(a(this).data("month")))}),l.find(".jqms-picker-previous").click(function(a){var b=parseInt(l.data("year"))-1;l.data("year",b),l.find("span.jqms-picker-title").text(b)}),l.find(".jqms-picker-next").click(function(a){var b=parseInt(l.data("year"))+1;l.data("year",b),l.find("span.jqms-picker-title").text(b)}),d.append(i);for(var m=a('<div class="jqms-view-container"><div class="jqms-month-view-container"><div class="jqms-month-view '+(_.isString(b)?b:"")+'" tabindex="-1"></div></div><div class="jqms-list-view"><ul class="jqms-list-items"></ul></div></div>'),n=m.find(".jqms-month-view"),o=new Date(c.date.getFullYear(),c.date.getMonth(),1),p=new Date(c.date.getFullYear(),c.date.getMonth()+1,1),q=0;q<o.getDay();q++)n.append('<div class="jqms-day-cell"></div>');for(var r=_.filter(c.events,function(a){if(a&&a.start&&a.end&&c&&c.date){if(a.start>=o&&a.start<p)return!0;if(a.end>=o&&a.end<p)return!0;if(a.start<o&&a.end>p)return!0}return!1}),s=new Date(c.date.getFullYear(),c.date.getMonth()+1,0).getDate(),t=1;t<=s;t++){var u=a('<div class="jqms-day-cell"></div>');u.append("<span>"+t+"</span>"),u.data("day",t),u.click(function(){c.date.setDate(a(this).data("day")),e()}),f.getFullYear()===c.date.getFullYear()&&f.getMonth()===c.date.getMonth()&&f.getDate()===t&&u.addClass("jqms-today"),c.date.getDate()===t&&u.addClass("jqms-active");var v=new Date(c.date.getFullYear(),c.date.getMonth(),t),w=new Date(c.date.getFullYear(),c.date.getMonth(),t+1);_.filter(r,function(a){if(a&&a.start&&a.end){if(a.start>=v&&a.start<w)return!0;if(a.end>v&&a.end<w)return!0;if(a.start<v&&a.end>=w)return!0}return!1}).length>0&&u.append("<span>&#9679;</span>"),n.append(u)}s+q>35?n.addClass("jqms-long"):s+q===28&&n.addClass("jqms-short"),n.on("webkitAnimationEnd animationend",function(){n.removeClass("animated slideInRight slideInLeft")}),n.click(function(a){a.preventDefault(),a.stopPropagation()});var v=new Date(c.date.getFullYear(),c.date.getMonth(),c.date.getDate()),w=new Date(c.date.getFullYear(),c.date.getMonth(),c.date.getDate()+1),x=_.filter(r,function(a){if(a&&a.start&&a.end){if(a.start>=v&&a.start<w)return!0;if(a.end>v&&a.end<w)return!0;if(a.start<v&&a.end>=w)return!0}return!1}),y=m.find(".jqms-list-items"),v=new Date(c.date.getFullYear(),c.date.getMonth(),c.date.getDate()),w=new Date(c.date.getFullYear(),c.date.getMonth(),c.date.getDate()+1);_.each(_.sortBy(x,function(a){return a.start.getTime()}),function(b){var d,e;if(b.start.getTime()===v.getTime()&&b.end.getTime()===w.getTime())d=c.labels.allday,e="&nbsp;";else if(b.start>=v&&b.start<w)if(c.use24HourClock)d=(b.start.getHours()<10?"0":"")+b.start.getHours()+":"+(b.start.getMinutes()<10?"0":"")+b.start.getMinutes();else{var f=b.start.getHours()%12;0===f&&(f=12),d=(f<10?"0":"")+f+":"+(b.start.getMinutes()<10?"0":"")+b.start.getMinutes()+(b.start.getHours()>12?" PM":" AM")}else d=b.start<v&&b.end>=w?c.labels.allday:c.labels.ends;if(b.end>v&&b.end<w)if(c.use24HourClock)e=(b.end.getHours()<10?"0":"")+b.end.getHours()+":"+(b.end.getMinutes()<10?"0":"")+b.end.getMinutes();else{var g=b.end.getHours()%12;0===g&&(g=12),e=(g<10?"0":"")+g+":"+(b.end.getMinutes()<10?"0":"")+b.end.getMinutes()+(b.end.getHours()>12?" PM":" AM")}else e=b.end<v&&b.end>=w?c.labels.allday:"&nbsp;";var h=a("<li><div><span>"+d+"</span><span>"+(b.allday?"&nbsp;":e)+"</span></div><span>"+b.title+"</span></li>");h.data("event",JSON.stringify(b)),h.click(function(b){c.onEventClick(JSON.parse(a(this).data("event")),b)}),y.append(h)}),d.append(m);var z=a('<div class="jqms-footer"><a class="jqms-today">'+c.labels.today+'</a><a class="jqms-new-event">'+c.labels.newevent+"</a></div>");if(z.find(".jqms-today").click(function(){var a=new Date;c.date.setDate(a.getDate()),k(a.getFullYear(),a.getMonth())}),_.isFunction(c.onEventCreate)?z.find(".jqms-new-event").click(function(a){c.onEventCreate(c.date,a)}):z.find(".jqms-new-event").hide(),d.append(z),window.IScroll){var A=new IScroll(d.find(".jqms-month-view-container")[0],{disableMouse:!0,disablePointer:!0,bindToWrapper:!0,scrollX:!0,probeType:3,eventPassthrough:!0}),B=!1,C=!1;A.on("scroll",function(b){this.x>.05*a(window).width()?B=!0:this.x<-(.05*a(window).width())?C=!0:(B=!1,C=!1)}),d.find(".jqms-month-view").on("touchend",function(){C?g():B&&h()})}};return e(),this}}(jQuery);